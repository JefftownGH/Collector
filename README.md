# Collector


![Logo](Images/Collector128.png)

A powershell script that compiles multiple source code files into a single file.
Designed for use with Autodesk's Inventor iLogic scripts and Autocad LISP files.
It is intended to allow use of external IDEs such as Visual Studio and support
class or module-per-file coding organization.

This is handy for autolisp routines as well, as they can be stored in seperate files
but combined into a single lisp file.

It is also useful when developing an Inventor Add-In and you want to perform testing
in the iLogic environment.  The script will collect any source code files within a
single directory that contains the proper tag in the first line and insert them into
a single iLogic file.

## Use

To use, include tags into the source code files that you want to collect.

* ``</Collector>`` : include this tag in the first line of each file you want to collect.
* ``</CollectorHeader>`` : Include this tag in the first line of header and main files. This will ensure the file is placed at the top of the collected file.
* ``<CollectorPrepend>;</CollectorPrepend>`` : include this line after any line of code to comment out that line at collection time.  Use this for module wrappers that help VS, but need to be removed for iLogic to work properly.

When ready to compile, run this powershell script to combine the files into a single file.
If running from the command line, you may need to issue the command like so if permissions
issues prevent running the powershell script.

``powershell -ExecutionPolicy ByPass -File .\Collector.ps1``

The current directory name is used as the file name with an .iLogicVB extension.  This script will overwrite any file with that same name.  If the file is currently open, it will need to be closed or deleted to proceed.

## Example

See the /Example/ folder for a simple set of code files that illustrates Collector
in action. The Example.iLogicVB file has been generated by the Collector.ps1 script.
The files "ExporterClass.vb", "Main.vb", and "SphereClass.vb" contain the Collector
tags that tells the script what to do.

## CLI version

There is current work being done to create a fully CLI version of this tool.  It will have more options related to specifying input/output files, file names, recursive searches, etc.
